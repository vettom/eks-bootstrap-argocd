apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: 00-core-apps
  namespace: argocd
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  destination:
    namespace: argocd
    server: https://kubernetes.default.svc
  project: default
  sources:
    - repoURL: https://github.com/vettom/eks-bootstrap-argocd.git
      targetRevision: HEAD
      path: core-apps
      helm:
        valuesObject: 
          cluster_name: "eks-auto-demo"
          argocd:
            version: "9.2.0"
            argo_url: "argocd.vettom.online"
          externaldns:
            version: "1.19.0"
            dnsZones:
              - "vettom.online"
              - "*.prd.vettom.online"
          certmanager:
            version: "v1.19.2"
            replicaCount: 1
          metricsserver:
            version: "3.13.0"
          envoyGateway:
            version: "v1.6.1"
            replicas: 1
          prometheus_crds:
            version: "25.0.1"
          prometheus_stack:
            version: "80.6.0"
            grafana_url: "grafana.vettom.online"
            prometheus_url: "prometheus.vettom.online"
            alertmanager_url: "alertmanager.vettom.online"
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true
